global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'petclinic-jmx'
    static_configs:
      - targets: ['app:9099']

    metric_relabel_configs:
      # CPU Load (din process_cpu_seconds_total)
      - source_labels: [__name__]
        regex: 'process_cpu_seconds_total'
        action: replace
        target_label: __name__
        replacement: 'java_lang_OperatingSystem_CpuLoad'

      # Free Memory (din process_resident_memory_bytes)
      - source_labels: [__name__]
        regex: 'process_resident_memory_bytes'
        action: replace
        target_label: __name__
        replacement: 'java_lang_OperatingSystem_FreeMemorySize'

      # Heap Memory (Micrometer: jvm_memory_bytes_used area=heap)
      - source_labels: [__name__, area]
        regex: 'jvm_memory_bytes_used;heap'
        action: replace
        target_label: __name__
        replacement: 'java_lang_Memory_HeapMemoryUsage_used'

      # Uptime (din process_start_time_seconds -> redenumire simplÄƒ)
      - source_labels: [__name__]
        regex: 'process_start_time_seconds'
        action: replace
        target_label: __name__
        replacement: 'java_lang_Runtime_Uptime'
